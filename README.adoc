# Dauphine Open Data image:https://travis-ci.org/edoreld/Dauphine-Data.svg?branch=master["Build Status", link="https://travis-ci.org/edoreld/Dauphine-Data"] image:https://sonarcloud.io/api/project_badges/measure?project=edoreld_Dauphine-Open-Data&metric=alert_status["Quality Gate", link="https://sonarcloud.io/dashboard?id=edoreld_Dauphine-Open-Data"]

## Sonar analysis

image:https://sonarcloud.io/api/project_badges/measure?project=edoreld_Dauphine-Open-Data&metric=bugs["Bugs", link="https://sonarcloud.io/dashboard?id=edoreld_Dauphine-Open-Data"]
image:https://sonarcloud.io/api/project_badges/measure?project=edoreld_Dauphine-Open-Data&metric=vulnerabilities["Vulnerabilities", link="https://sonarcloud.io/dashboard?id=edoreld_Dauphine-Open-Data"]
image:https://sonarcloud.io/api/project_badges/measure?project=edoreld_Dauphine-Open-Data&metric=code_smells["Code Smells", link="https://sonarcloud.io/dashboard?id=edoreld_Dauphine-Open-Data"]

image:https://sonarcloud.io/api/project_badges/measure?project=edoreld_Dauphine-Open-Data&metric=coverage["Coverage", link="https://sonarcloud.io/dashboard?id=edoreld_Dauphine-Open-Data"]
image:https://sonarcloud.io/api/project_badges/measure?project=edoreld_Dauphine-Open-Data&metric=duplicated_lines_density["Duplicated Lines", link="https://sonarcloud.io/dashboard?id=edoreld_Dauphine-Open-Data"]

## Description

L’université Paris-Dauphine crée et met à jour de nombreuses données publiques, qui sont parfois mises à disposition uniquement via son site web, voire parfois non mises à disposition et simplement conservées dans des bases de données.

Le mouvement open data considère que les données bénéficient d’une exposition maximale, dans des formats facilement lisibles par des machines. Entre autres bénéfices, cette approche facilite la réutilisation et l’innovation.

Ce projet a pour but de créer une plate-forme qui servira à la mise à disposition de certaines données publiques de Paris-Dauphine. Il visera à mettre également à disposition certaines données non publiques après authentification. Par exemple, un enseignant a droit d’accès aux adresses e-mail des étudiants qui suivent son cours, mais ces données ne sont pas publiques.

## Cahier des Charges

Il a été décidé de repartir de zéro afin d'éviter de devoir corriger ou découvrir trop de comportements non souhaités.
Le projet va se décomposer en 2 parties.

* La lib qui contient les entités et les Dao
* Le serveur qui contient les servlets et qui dépend de la lib.

### Itération 1
* 5 Entités : Person, Course, Lecture, Planning
* 1 Dao générique implémentant un CRUD simple.
* 1 Servlet générique exposant les entités en lecture seule, en Json et XML
* Un test pour chaque URL exposée via Arquillian

### Itération 2 :
* Sérialisation de certaines entités sous d'autres formats :
** Course au format CDM-fr
** Planning au format VCal
** Person au format VCard
* Réalisation d'un client simple pour une démo
* Déploiement dans IBM Cloud
* Prise de contact avec la DSI de dauphine pour anticiper les fonctionnalites de l'itération 3 (URGENT)

### Itération 3 :


#### El Amrani

* import vcal
* injecteur vcal démarrage

#### Omar

* import vcard
* injecteur vcard démarrage

#### Taric

* route pour faire des filtres sur l'entité Person

#### Javier

* route pour faire des filtres sur l'entité Course
* création de classe pour faciliter la création des filtres pour la recherche des entités

#### Barth

* Gestion des comptes et authentification
* Gestion des privilèges et controle d'accès
* Ces deux fonctionnalités seront développées de facon à être au maximum réutilisables lors de l'intégration avec le CAS de dauphine

#### Arnaud

* Tracage des requetes
* Gestion des quotas

## Connexion au cloud d'IBM
Sur la base du déploiement que j'avais fait, Barthélémy a crée un client avec swagger.
    * Pour vous connecter au cloud, vous disposer de :
    ** l'URL de base à l'adresse : https://dauphine-open-datas-swagger-ui.eu-gb.mybluemix.net
    
    ** Voici un exemple de commande curl pour faire un post via le client swagger :
    curl -X POST "https://barth-dauphine-open-datas.eu-gb.mybluemix.net/person" -H "accept: application/json" -H "Content-Type: application/json" -d "{\"firstName\":\"Didier\",\"lastName\":\"Sana\",\"ine\":\"187383\",\"office\":\"B134\",\"phoneNumer\":\"0183738\",\"training\":\"Mangement\",\"fax\":\"183938\",\"isActive\":true}"
    
    **pour avoir la liste des personnes avec un get :
  curl -X GET "https://barth-dauphine-open-datas.eu-gb.mybluemix.net/person" -H "accept: application/json"
    
## Swagger

La doc sur swagger se trouve link:doc/swagger.adoc[ici]

## Swagger-ui

Swagger-ui est déployé automatiquement sur ibmcloud : https://dauphine-open-datas-swagger-ui.eu-gb.mybluemix.net

Pour le lancer localement :
* installer le package npm http-server
* `cd swagger-ui-dist && http-server --cors`

## CLI

Un client en ligne de commande est généré par le script `./scripts/generate-cli.sh`.

Pour créer un cours:

  ./cli/client.sh  createCourse courseID=="42" courseName==maths courseDescription==complique instructionLanguage==fr

Pour lister les cours:

  ./cli/client.sh listCourses

Pour récupérer le cours avec l'identifiant 1:

  ./cli/client.sh getCourse id=1

Pour afficher toutes les commandes disponibles:

  ./cli/client.sh --help
  
  ## Une nouvelle fonctionnalité a été ajoutée pour faciliter les recherches sur la classe person ainsi que des Tests Junit
     3 champs ont été retenus pour la recherche:
          * le nom    qui fait référence au champ : firstName
          * le prénom qui fait référence au champ : lastName
          * le cours  qui fait référence au champ : course
          * Voici quelques commandes pour faire des tests avec curl:
         
           ** Faites un post avec en local avec curl :
           
curl -X POST "http://localhost:8080/person" -H "accept: application/json" -H "Content-Type: application/json" -d "{\"firstName\":\"Dani\",\"lastName\":\"Sana\",\"ine\":\"187383\",\"office\":\"B134\",\"phoneNumer\":\"0183738\",\"training\":\"Mangement\",\"fax\":\"183938\",\"isActive\":true}"

           ** Faites  un get pour si tout marche 
         
  curl http://localhost:8080/person/personfilter?lastName=Sana&firstName=Dani
         
       
    
